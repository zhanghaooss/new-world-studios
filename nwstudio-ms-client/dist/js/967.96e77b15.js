"use strict";(self["webpackChunkbmdstudio_ms_client"]=self["webpackChunkbmdstudio_ms_client"]||[]).push([[967],{4967:function(e,t,r){r.r(t),r.d(t,{default:function(){return m}});var o=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"form",staticStyle:{width:"600px"},attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"封面图片",prop:"cover"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:`${e.UPLOADURL}/upload`,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.form.cover?t("img",{staticClass:"avatar",staticStyle:{"object-fit":"cover"},attrs:{src:e.form.cover}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t("el-form-item",{attrs:{label:"电影类别",prop:"categoryid"}},[t("el-radio-group",{model:{value:e.form.categoryId,callback:function(t){e.$set(e.form,"categoryId",t)},expression:"form.categoryId"}},[t("el-radio",{attrs:{label:1}},[e._v("热映")]),t("el-radio",{attrs:{label:2}},[e._v("待映")]),t("el-radio",{attrs:{label:3}},[e._v("经典")])],1)],1),t("el-form-item",{attrs:{label:"电影名称",prop:"title"}},[t("el-input",{attrs:{placeholder:"请输入要添加的电影名称"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),t("el-form-item",{attrs:{label:"电影类型",prop:"type"}},[t("el-select",{attrs:{multiple:"",placeholder:"请选择电影类型"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.types,(function(e){return t("el-option",{key:e.id,attrs:{label:e.typename,value:e.typename}})})),1)],1),t("el-form-item",{attrs:{label:"电影主演",prop:"starActor"}},[t("el-select",{attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入主演名称","remote-method":e.remoteMethod,loading:e.loading},model:{value:e.form.starActor,callback:function(t){e.$set(e.form,"starActor",t)},expression:"form.starActor"}},e._l(e.actors,(function(e){return t("el-option",{key:e.id,attrs:{label:e.actor_name,value:e.actor_name}})})),1)],1),t("el-form-item",{attrs:{label:"上映时间",prop:"showingon"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-m-d"},model:{value:e.form.showingon,callback:function(t){e.$set(e.form,"showingon",t)},expression:"form.showingon"}})],1),t("el-form-item",{attrs:{label:"电影评分",prop:"score"}},[t("el-rate",{staticStyle:{height:"40px",display:"flex","align-items":"center"},attrs:{colors:e.colors},model:{value:e.form.score,callback:function(t){e.$set(e.form,"score",t)},expression:"form.score"}})],1),t("el-form-item",{attrs:{label:"电影时长",prop:"duration"}},[t("el-input",{model:{value:e.form.duration,callback:function(t){e.$set(e.form,"duration",t)},expression:"form.duration"}})],1),t("el-form-item",{attrs:{label:"电影简介",prop:"description"}},[t("div",{staticStyle:{border:"1px solid #ccc"}},[t("Toolbar",{staticStyle:{"border-bottom":"1px solid #ccc"},attrs:{editor:e.editor,defaultConfig:e.toolbarConfig,mode:e.mode}}),t("Editor",{staticStyle:{height:"300px","overflow-y":"hidden"},attrs:{defaultConfig:e.editorConfig,mode:e.mode},on:{onCreated:e.onCreated},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)]),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("立即创建")]),t("el-button",[e._v("取消")])],1)],1)],1)},a=[],s=r(1294),l=r(6126),i={components:{Editor:l.M,Toolbar:l.o},data(){return{loading:!1,actors:[],types:[],editor:null,toolbarConfig:{},editorConfig:{placeholder:"请输入内容..."},mode:"default",colors:["#99A9BF","#F7BA2A","#FF9900"],form:{cover:"",categoryId:1,title:"",type:[],starActor:[],showingon:"",score:4,duration:"",description:"<p>hello</p>"},rules:{cover:[{required:!0,message:"该字段必填",trigger:"blur"}],categoryId:[{required:!0,message:"该字段必填",trigger:"change"}],title:[{required:!0,message:"该字段必填",trigger:"blur"}],type:[{required:!0,message:"该字段必填",trigger:"change"}],starActor:[{required:!0,message:"该字段必填",trigger:"blur"}],showingon:[{required:!0,message:"该字段必填",trigger:"change"}],score:[{required:!0,message:"该字段必填",trigger:"blur"}],duration:[{required:!0,message:"该字段必填",trigger:"blur"}],description:[{required:!0,message:"该字段必填",trigger:"blur"}]}}},methods:{onCreated(e){this.editor=Object.seal(e)},remoteMethod(e){s.Z.actorApi.queryActorByName({name:e}).then((e=>{this.actors=e.data.data}))},getTypes(){s.Z.movieApi.queryMoiveType().then((e=>{this.types=e.data.data}))},submit(){this.form.type=this.form.type.join("／"),this.form.starActor=this.form.starActor.join("／"),this.$refs["form"].validate((e=>{e&&s.Z.movieApi.addMovie(this.form).then((e=>{console.log(e),200==e.data.code&&(this.$message({message:"恭喜添加成功",type:"success"}),this.$refs["form"].resetFields())}))}))},handleAvatarSuccess(e,t){console.log("上传成功",e),this.form.cover=e.data},beforeAvatarUpload(e){const t="image/jpeg"===e.type,r="image/png"===e.type,o=e.size/1024/1024<2;return t||r?o||this.$message.error("上传头像图片大小不能超过 2MB!"):this.$message.error("上传头像图片只能是 JPG/PNG 格式且大小不能超过 2MB!"),(t||r)&&o}},mounted(){this.getTypes()},beforeDestroy(){const e=this.editor;null!=e&&e.destroy()}},c=i,n=r(1001),d=(0,n.Z)(c,o,a,!1,null,"6a39f494",null),m=d.exports}}]);
//# sourceMappingURL=967.96e77b15.js.map