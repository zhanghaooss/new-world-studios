{"ast":null,"code":"import SeatSelector from '@/libs/SeatSelector.js';\nimport httpApi from '@/http';\nexport default {\n  data() {\n    return {\n      rows: 0,\n      cols: 0,\n      seatSelector: null,\n      // 座位模板对象\n      id: this.$route.params.id // 放映厅的ID\n    };\n  },\n\n  methods: {\n    /**\r\n     * 生成座位模板，并且绘制在canvas中\r\n     */\n    step1() {\n      let row = parseInt(this.rows);\n      let col = parseInt(this.cols);\n      this.seatSelector = new SeatSelector(row, col, 'canvas'); // 创建SeatSelector对象  传入行数、列数、canvas\n      this.seatSelector.draw(); // 将座位模板绘制在canvas中\n    },\n\n    /**\r\n     * 撤销选中\r\n     */\n    step2() {\n      if (this.seatSelector) {\n        this.seatSelector.setNoSelect();\n      }\n    },\n    /**\r\n     * 设置选中的座位为普通座位\r\n     */\n    step3_1() {\n      if (this.seatSelector) {\n        this.seatSelector.setSelectedSeatsToNormalSeats();\n      }\n    },\n    /**\r\n     * 设置选中的座位为过道\r\n     */\n    step3_2() {\n      if (this.seatSelector) {\n        this.seatSelector.setSelectedSeatsToGangway();\n      }\n    },\n    /**\r\n     * 选好了\r\n     */\n    step4() {\n      if (this.seatSelector) {\n        try {\n          let seat_template = this.seatSelector.getSeatTemplateJsonString();\n          let room_size = this.seatSelector.getSeatCount();\n          let id = this.id;\n          // 发送请求，更新放映厅的座位模板\n          // this.$http.CinemaRoomApi.updateSeatTemplate({\n          httpApi.cinemaRoomApi.updateSeatTemplate({\n            id,\n            seat_template,\n            room_size\n          }).then(res => {\n            console.log('更新放映厅的座位模板', res);\n            if (res.data.code == 200) {\n              this.$message.success('更新放映厅的座位模板完成');\n              this.$router.go(-1);\n            }\n          });\n        } catch (error) {\n          this.$message.error(error);\n        }\n      }\n    }\n  }\n};","map":{"version":3,"names":["SeatSelector","httpApi","data","rows","cols","seatSelector","id","$route","params","methods","step1","row","parseInt","col","draw","step2","setNoSelect","step3_1","setSelectedSeatsToNormalSeats","step3_2","setSelectedSeatsToGangway","step4","seat_template","getSeatTemplateJsonString","room_size","getSeatCount","cinemaRoomApi","updateSeatTemplate","then","res","console","log","code","$message","success","$router","go","error"],"sources":["src/views/cinema/CinemaRoomSeatTemplate.vue"],"sourcesContent":["<template>\r\n\t<div>\r\n\t\t<!-- 面包屑导航 -->\r\n\r\n\t\t<el-divider></el-divider>\r\n\r\n\t\t<!-- 配置座位模板内容 -->\r\n\t\t<el-container>\r\n\t\t\t<el-aside>\r\n\t\t\t\t<!-- 时间线 -->\r\n\t\t\t\t<el-timeline>\r\n\t\t\t\t\t<!-- 第一步 -->\r\n\t\t\t\t\t<el-timeline-item>\r\n\t\t\t\t\t\t<el-card class=\"box-card\">\r\n\t\t\t\t\t\t\t<div slot=\"header\" class=\"clearfix\">\r\n\t\t\t\t\t\t\t\t<span>编辑坐标系</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<el-form label-width=\"60px\">\r\n\t\t\t\t\t\t\t\t<el-form-item label=\"行数\">\r\n\t\t\t\t\t\t\t\t\t<el-input v-model=\"rows\" placeholder=\"请输入行数\" size=\"small\" />\r\n\t\t\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t\t\t<el-form-item label=\"列数\">\r\n\t\t\t\t\t\t\t\t\t<el-input v-model=\"cols\" placeholder=\"请输入列数\" size=\"small\" />\r\n\t\t\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t\t\t<el-button type=\"primary\" plain style=\"width: 100%\" size=\"small\" @click=\"step1()\">\r\n\t\t\t\t\t\t\t\t\t生成座位模板\r\n\t\t\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t\t\t</el-form>\r\n\t\t\t\t\t\t</el-card>\r\n\t\t\t\t\t</el-timeline-item>\r\n\t\t\t\t\t<!-- 第二步 -->\r\n\t\t\t\t\t<el-timeline-item>\r\n\t\t\t\t\t\t<el-card class=\"box-card\">\r\n\t\t\t\t\t\t\t<div slot=\"header\" class=\"clearfix\">\r\n\t\t\t\t\t\t\t\t<span>选择座位区域（框选）</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" plain style=\"width: 100%\" size=\"small\" @click=\"step2()\">\r\n\t\t\t\t\t\t\t\t撤销选中\r\n\t\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t\t</el-card>\r\n\t\t\t\t\t</el-timeline-item>\r\n\r\n\t\t\t\t\t<!-- 第三步 -->\r\n\t\t\t\t\t<el-timeline-item>\r\n\t\t\t\t\t\t<el-card class=\"box-card\">\r\n\t\t\t\t\t\t\t<div slot=\"header\" class=\"clearfix\">\r\n\t\t\t\t\t\t\t\t<span>选择座位类型</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" plain style=\"width: 100%\" size=\"small\" @click=\"step3_1()\">\r\n\t\t\t\t\t\t\t\t普通座位\r\n\t\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t\t\t<br /><br />\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" plain style=\"width: 100%\" size=\"small\" @click=\"step3_2()\">\r\n\t\t\t\t\t\t\t\t过道\r\n\t\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t\t</el-card>\r\n\t\t\t\t\t</el-timeline-item>\r\n\r\n\t\t\t\t\t<!-- 第四步 -->\r\n\t\t\t\t\t<el-timeline-item>\r\n\t\t\t\t\t\t<el-card class=\"box-card\">\r\n\t\t\t\t\t\t\t<div slot=\"header\" class=\"clearfix\">\r\n\t\t\t\t\t\t\t\t<span>确认模板</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<el-button type=\"success\" style=\"width: 100%\" size=\"small\" @click=\"step4()\">\r\n\t\t\t\t\t\t\t\t选好了\r\n\t\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t\t</el-card>\r\n\t\t\t\t\t</el-timeline-item>\r\n\t\t\t\t</el-timeline>\r\n\t\t\t</el-aside>\r\n\t\t\t<el-main>\r\n\t\t\t\t<!-- 提示内容 -->\r\n\t\t\t\t<div class=\"tip\">\r\n\t\t\t\t\t<div class=\"tip-item\" style=\"background: #36d6\"></div>\r\n\t\t\t\t\t未选择座位 &nbsp;&nbsp;\r\n\t\t\t\t\t<div class=\"tip-item\" style=\"background: #36d\"></div>\r\n\t\t\t\t\t已选择座位 &nbsp;&nbsp;\r\n\t\t\t\t\t<div class=\"tip-item\" style=\"background: #a11\"></div>\r\n\t\t\t\t\t普通座位 &nbsp;&nbsp;\r\n\t\t\t\t\t<div class=\"tip-item\" style=\"background: #3333\"></div>\r\n\t\t\t\t\t过道\r\n\t\t\t\t</div>\r\n\t\t\t\t<el-divider></el-divider>\r\n\t\t\t\t<el-divider>电影荧屏</el-divider>\r\n\r\n\t\t\t\t<!-- 画布 -->\r\n\t\t\t\t<canvas id=\"canvas\"></canvas>\r\n\t\t\t</el-main>\r\n\t\t</el-container>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport SeatSelector from '@/libs/SeatSelector.js';\r\n\timport httpApi from '@/http';\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\trows: 0,\r\n\t\t\t\tcols: 0,\r\n\t\t\t\tseatSelector: null, // 座位模板对象\r\n\t\t\t\tid: this.$route.params.id, // 放映厅的ID\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t/**\r\n\t\t\t * 生成座位模板，并且绘制在canvas中\r\n\t\t\t */\r\n\t\t\tstep1() {\r\n\t\t\t\tlet row = parseInt(this.rows);\r\n\t\t\t\tlet col = parseInt(this.cols);\r\n\t\t\t\tthis.seatSelector = new SeatSelector(row, col, 'canvas'); // 创建SeatSelector对象  传入行数、列数、canvas\r\n\t\t\t\tthis.seatSelector.draw(); // 将座位模板绘制在canvas中\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 撤销选中\r\n\t\t\t */\r\n\t\t\tstep2() {\r\n\t\t\t\tif (this.seatSelector) {\r\n\t\t\t\t\tthis.seatSelector.setNoSelect();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 设置选中的座位为普通座位\r\n\t\t\t */\r\n\t\t\tstep3_1() {\r\n\t\t\t\tif (this.seatSelector) {\r\n\t\t\t\t\tthis.seatSelector.setSelectedSeatsToNormalSeats();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 设置选中的座位为过道\r\n\t\t\t */\r\n\t\t\tstep3_2() {\r\n\t\t\t\tif (this.seatSelector) {\r\n\t\t\t\t\tthis.seatSelector.setSelectedSeatsToGangway();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * 选好了\r\n\t\t\t */\r\n\t\t\tstep4() {\r\n\t\t\t\tif (this.seatSelector) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tlet seat_template = this.seatSelector.getSeatTemplateJsonString();\r\n\t\t\t\t\t\tlet room_size = this.seatSelector.getSeatCount();\r\n\t\t\t\t\t\tlet id = this.id;\r\n\t\t\t\t\t\t// 发送请求，更新放映厅的座位模板\r\n\t\t\t\t\t\t// this.$http.CinemaRoomApi.updateSeatTemplate({\r\n\t\t\t\t\t\thttpApi.cinemaRoomApi\r\n\t\t\t\t\t\t\t.updateSeatTemplate({\r\n\t\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\t\tseat_template,\r\n\t\t\t\t\t\t\t\troom_size,\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\t\t\tconsole.log('更新放映厅的座位模板', res);\r\n\t\t\t\t\t\t\t\tif (res.data.code == 200) {\r\n\t\t\t\t\t\t\t\t\tthis.$message.success('更新放映厅的座位模板完成');\r\n\t\t\t\t\t\t\t\t\tthis.$router.go(-1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tthis.$message.error(error);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t};\r\n</script>\r\n\r\n<style scoped>\r\n\t#canvas {\r\n\t\tborder: 1px dashed #999;\r\n\t\tborder-radius: 4px;\r\n\t\tdisplay: none;\r\n\t\tmargin: 0 auto;\r\n\t}\r\n\t.tip {\r\n\t\ttext-align: center;\r\n\t\tmargin-bottom: 20px;\r\n\t}\r\n\t.tip-item {\r\n\t\tdisplay: inline-block;\r\n\t\twidth: 20px;\r\n\t\theight: 20px;\r\n\t\tvertical-align: middle;\r\n\t}\r\n</style>\r\n"],"mappings":"AA8FA,OAAAA,YAAA;AACA,OAAAC,OAAA;AACA;EACAC,KAAA;IACA;MACAC,IAAA;MACAC,IAAA;MACAC,YAAA;MAAA;MACAC,EAAA,OAAAC,MAAA,CAAAC,MAAA,CAAAF,EAAA;IACA;EACA;;EACAG,OAAA;IACA;AACA;AACA;IACAC,MAAA;MACA,IAAAC,GAAA,GAAAC,QAAA,MAAAT,IAAA;MACA,IAAAU,GAAA,GAAAD,QAAA,MAAAR,IAAA;MACA,KAAAC,YAAA,OAAAL,YAAA,CAAAW,GAAA,EAAAE,GAAA;MACA,KAAAR,YAAA,CAAAS,IAAA;IACA;;IAEA;AACA;AACA;IACAC,MAAA;MACA,SAAAV,YAAA;QACA,KAAAA,YAAA,CAAAW,WAAA;MACA;IACA;IAEA;AACA;AACA;IACAC,QAAA;MACA,SAAAZ,YAAA;QACA,KAAAA,YAAA,CAAAa,6BAAA;MACA;IACA;IAEA;AACA;AACA;IACAC,QAAA;MACA,SAAAd,YAAA;QACA,KAAAA,YAAA,CAAAe,yBAAA;MACA;IACA;IAEA;AACA;AACA;IACAC,MAAA;MACA,SAAAhB,YAAA;QACA;UACA,IAAAiB,aAAA,QAAAjB,YAAA,CAAAkB,yBAAA;UACA,IAAAC,SAAA,QAAAnB,YAAA,CAAAoB,YAAA;UACA,IAAAnB,EAAA,QAAAA,EAAA;UACA;UACA;UACAL,OAAA,CAAAyB,aAAA,CACAC,kBAAA;YACArB,EAAA;YACAgB,aAAA;YACAE;UACA,GACAI,IAAA,CAAAC,GAAA;YACAC,OAAA,CAAAC,GAAA,eAAAF,GAAA;YACA,IAAAA,GAAA,CAAA3B,IAAA,CAAA8B,IAAA;cACA,KAAAC,QAAA,CAAAC,OAAA;cACA,KAAAC,OAAA,CAAAC,EAAA;YACA;UACA;QACA,SAAAC,KAAA;UACA,KAAAJ,QAAA,CAAAI,KAAA,CAAAA,KAAA;QACA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}