{"ast":null,"code":"import SeatSelector from \"@/libs/SeatSelector.js\";\nexport default {\n  data() {\n    return {\n      rows: 0,\n      cols: 0,\n      seatSelector: null,\n      // 座位模板对象\n      id: this.$route.params.id // 放映厅的ID\n    };\n  },\n\n  methods: {\n    /**\r\n     * 生成座位模板，并且绘制在canvas中\r\n     */\n    step1() {\n      let row = parseInt(this.rows);\n      let col = parseInt(this.cols);\n      this.seatSelector = new SeatSelector(row, col, \"canvas\"); // 创建SeatSelector对象  传入行数、列数、canvas\n      this.seatSelector.draw(); // 将座位模板绘制在canvas中\n    },\n\n    /**\r\n     * 撤销选中\r\n     */\n    step2() {\n      if (this.seatSelector) {\n        this.seatSelector.setNoSelect();\n      }\n    },\n    /**\r\n     * 设置选中的座位为普通座位\r\n     */\n    step3_1() {\n      if (this.seatSelector) {\n        this.seatSelector.setSelectedSeatsToNormalSeats();\n      }\n    },\n    /**\r\n     * 设置选中的座位为过道\r\n     */\n    step3_2() {\n      if (this.seatSelector) {\n        this.seatSelector.setSelectedSeatsToGangway();\n      }\n    },\n    /**\r\n     * 选好了\r\n     */\n    step4() {\n      if (this.seatSelector) {\n        try {\n          let seat_template = this.seatSelector.getSeatTemplateJsonString();\n          let room_size = this.seatSelector.getSeatCount();\n          let id = this.id;\n          // 发送请求，更新放映厅的座位模板\n          this.$http.CinemaRoomApi.updateSeatTemplate({\n            id,\n            seat_template,\n            room_size\n          }).then(res => {\n            console.log(\"更新放映厅的座位模板\", res);\n            if (res.data.code == 200) {\n              this.$message.success(\"更新放映厅的座位模板完成\");\n              this.$router.go(-1);\n            }\n          });\n        } catch (error) {\n          this.$message.error(error);\n        }\n      }\n    }\n  }\n};","map":{"version":3,"names":["SeatSelector","data","rows","cols","seatSelector","id","$route","params","methods","step1","row","parseInt","col","draw","step2","setNoSelect","step3_1","setSelectedSeatsToNormalSeats","step3_2","setSelectedSeatsToGangway","step4","seat_template","getSeatTemplateJsonString","room_size","getSeatCount","$http","CinemaRoomApi","updateSeatTemplate","then","res","console","log","code","$message","success","$router","go","error"],"sources":["src/views/cinema/CinemaRoomSeatTemplate.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <!-- 面包屑导航 -->\r\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n      <el-breadcrumb-item>首页</el-breadcrumb-item>\r\n      <el-breadcrumb-item>电影院管理</el-breadcrumb-item>\r\n      <el-breadcrumb-item>电影院列表</el-breadcrumb-item>\r\n      <el-breadcrumb-item>放映厅列表</el-breadcrumb-item>\r\n      <el-breadcrumb-item>配置座位模版</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <el-divider></el-divider>\r\n\r\n    <!-- 配置座位模板内容 -->\r\n    <el-container>\r\n      <el-aside>\r\n        <!-- 时间线 -->\r\n        <el-timeline>\r\n          <!-- 第一步 -->\r\n          <el-timeline-item>\r\n            <el-card class=\"box-card\">\r\n              <div slot=\"header\" class=\"clearfix\">\r\n                <span>编辑坐标系</span>\r\n              </div>\r\n              <el-form label-width=\"60px\">\r\n                <el-form-item label=\"行数\">\r\n                  <el-input\r\n                    v-model=\"rows\"\r\n                    placeholder=\"请输入行数\"\r\n                    size=\"small\"\r\n                  />\r\n                </el-form-item>\r\n                <el-form-item label=\"列数\">\r\n                  <el-input\r\n                    v-model=\"cols\"\r\n                    placeholder=\"请输入列数\"\r\n                    size=\"small\"\r\n                  />\r\n                </el-form-item>\r\n                <el-button\r\n                  type=\"primary\"\r\n                  plain\r\n                  style=\"width: 100%\"\r\n                  size=\"small\"\r\n                  @click=\"step1()\"\r\n                >\r\n                  生成座位模板\r\n                </el-button>\r\n              </el-form>\r\n            </el-card>\r\n          </el-timeline-item>\r\n          <!-- 第二步 -->\r\n          <el-timeline-item>\r\n            <el-card class=\"box-card\">\r\n              <div slot=\"header\" class=\"clearfix\">\r\n                <span>选择座位区域（框选）</span>\r\n              </div>\r\n              <el-button\r\n                type=\"primary\"\r\n                plain\r\n                style=\"width: 100%\"\r\n                size=\"small\"\r\n                @click=\"step2()\"\r\n              >\r\n                撤销选中\r\n              </el-button>\r\n            </el-card>\r\n          </el-timeline-item>\r\n\r\n          <!-- 第三步 -->\r\n          <el-timeline-item>\r\n            <el-card class=\"box-card\">\r\n              <div slot=\"header\" class=\"clearfix\">\r\n                <span>选择座位类型</span>\r\n              </div>\r\n              <el-button\r\n                type=\"primary\"\r\n                plain\r\n                style=\"width: 100%\"\r\n                size=\"small\"\r\n                @click=\"step3_1()\"\r\n              >\r\n                普通座位\r\n              </el-button>\r\n              <br /><br />\r\n              <el-button\r\n                type=\"primary\"\r\n                plain\r\n                style=\"width: 100%\"\r\n                size=\"small\"\r\n                @click=\"step3_2()\"\r\n              >\r\n                过道\r\n              </el-button>\r\n            </el-card>\r\n          </el-timeline-item>\r\n\r\n          <!-- 第四步 -->\r\n          <el-timeline-item>\r\n            <el-card class=\"box-card\">\r\n              <div slot=\"header\" class=\"clearfix\">\r\n                <span>确认模板</span>\r\n              </div>\r\n              <el-button\r\n                type=\"success\"\r\n                style=\"width: 100%\"\r\n                size=\"small\"\r\n                @click=\"step4()\"\r\n              >\r\n                选好了\r\n              </el-button>\r\n            </el-card>\r\n          </el-timeline-item>\r\n        </el-timeline>\r\n      </el-aside>\r\n      <el-main>\r\n        <!-- 提示内容 -->\r\n        <div class=\"tip\">\r\n          <div class=\"tip-item\" style=\"background: #36d6\"></div>\r\n          未选择座位 &nbsp;&nbsp;\r\n          <div class=\"tip-item\" style=\"background: #36d\"></div>\r\n          已选择座位 &nbsp;&nbsp;\r\n          <div class=\"tip-item\" style=\"background: #a11\"></div>\r\n          普通座位 &nbsp;&nbsp;\r\n          <div class=\"tip-item\" style=\"background: #3333\"></div>\r\n          过道\r\n        </div>\r\n        <el-divider></el-divider>\r\n        <el-divider>电影荧屏</el-divider>\r\n\r\n        <!-- 画布 -->\r\n        <canvas id=\"canvas\"></canvas>\r\n      </el-main>\r\n    </el-container>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport SeatSelector from \"@/libs/SeatSelector.js\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      rows: 0,\r\n      cols: 0,\r\n      seatSelector: null, // 座位模板对象\r\n      id: this.$route.params.id, // 放映厅的ID\r\n    };\r\n  },\r\n  methods: {\r\n    /**\r\n     * 生成座位模板，并且绘制在canvas中\r\n     */\r\n    step1() {\r\n      let row = parseInt(this.rows);\r\n      let col = parseInt(this.cols);\r\n      this.seatSelector = new SeatSelector(row, col, \"canvas\"); // 创建SeatSelector对象  传入行数、列数、canvas\r\n      this.seatSelector.draw(); // 将座位模板绘制在canvas中\r\n    },\r\n\r\n    /**\r\n     * 撤销选中\r\n     */\r\n    step2() {\r\n      if (this.seatSelector) {\r\n        this.seatSelector.setNoSelect();\r\n      }\r\n    },\r\n\r\n    /**\r\n     * 设置选中的座位为普通座位\r\n     */\r\n    step3_1() {\r\n      if (this.seatSelector) {\r\n        this.seatSelector.setSelectedSeatsToNormalSeats();\r\n      }\r\n    },\r\n\r\n    /**\r\n     * 设置选中的座位为过道\r\n     */\r\n    step3_2() {\r\n      if (this.seatSelector) {\r\n        this.seatSelector.setSelectedSeatsToGangway();\r\n      }\r\n    },\r\n\r\n    /**\r\n     * 选好了\r\n     */\r\n    step4() {\r\n      if (this.seatSelector) {\r\n        try {\r\n          let seat_template = this.seatSelector.getSeatTemplateJsonString();\r\n          let room_size = this.seatSelector.getSeatCount();\r\n          let id = this.id;\r\n          // 发送请求，更新放映厅的座位模板\r\n          this.$http.CinemaRoomApi.updateSeatTemplate({\r\n            id,\r\n            seat_template,\r\n            room_size,\r\n          }).then((res) => {\r\n            console.log(\"更新放映厅的座位模板\", res);\r\n            if (res.data.code == 200) {\r\n              this.$message.success(\"更新放映厅的座位模板完成\");\r\n              this.$router.go(-1);\r\n            }\r\n          });\r\n        } catch (error) {\r\n          this.$message.error(error);\r\n        }\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n#canvas {\r\n  border: 1px dashed #999;\r\n  border-radius: 4px;\r\n  display: none;\r\n  margin: 0 auto;\r\n}\r\n.tip {\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n}\r\n.tip-item {\r\n  display: inline-block;\r\n  width: 20px;\r\n  height: 20px;\r\n  vertical-align: middle;\r\n}\r\n</style>\r\n"],"mappings":"AAyIA,OAAAA,YAAA;AACA;EACAC,KAAA;IACA;MACAC,IAAA;MACAC,IAAA;MACAC,YAAA;MAAA;MACAC,EAAA,OAAAC,MAAA,CAAAC,MAAA,CAAAF,EAAA;IACA;EACA;;EACAG,OAAA;IACA;AACA;AACA;IACAC,MAAA;MACA,IAAAC,GAAA,GAAAC,QAAA,MAAAT,IAAA;MACA,IAAAU,GAAA,GAAAD,QAAA,MAAAR,IAAA;MACA,KAAAC,YAAA,OAAAJ,YAAA,CAAAU,GAAA,EAAAE,GAAA;MACA,KAAAR,YAAA,CAAAS,IAAA;IACA;;IAEA;AACA;AACA;IACAC,MAAA;MACA,SAAAV,YAAA;QACA,KAAAA,YAAA,CAAAW,WAAA;MACA;IACA;IAEA;AACA;AACA;IACAC,QAAA;MACA,SAAAZ,YAAA;QACA,KAAAA,YAAA,CAAAa,6BAAA;MACA;IACA;IAEA;AACA;AACA;IACAC,QAAA;MACA,SAAAd,YAAA;QACA,KAAAA,YAAA,CAAAe,yBAAA;MACA;IACA;IAEA;AACA;AACA;IACAC,MAAA;MACA,SAAAhB,YAAA;QACA;UACA,IAAAiB,aAAA,QAAAjB,YAAA,CAAAkB,yBAAA;UACA,IAAAC,SAAA,QAAAnB,YAAA,CAAAoB,YAAA;UACA,IAAAnB,EAAA,QAAAA,EAAA;UACA;UACA,KAAAoB,KAAA,CAAAC,aAAA,CAAAC,kBAAA;YACAtB,EAAA;YACAgB,aAAA;YACAE;UACA,GAAAK,IAAA,CAAAC,GAAA;YACAC,OAAA,CAAAC,GAAA,eAAAF,GAAA;YACA,IAAAA,GAAA,CAAA5B,IAAA,CAAA+B,IAAA;cACA,KAAAC,QAAA,CAAAC,OAAA;cACA,KAAAC,OAAA,CAAAC,EAAA;YACA;UACA;QACA,SAAAC,KAAA;UACA,KAAAJ,QAAA,CAAAI,KAAA,CAAAA,KAAA;QACA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}